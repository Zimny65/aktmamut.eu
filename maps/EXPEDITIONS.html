<!DOCTYPE html>
<html>
<head>
    <title>EXPEDITIONS</title>
    <link rel="icon" href="M32.png" type="image/png">
    
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css"/>
    
            <meta name="viewport" content="width=device-width,
                initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
            <style>
                #map_b33b6e6260203368c111134a9ea78e3e {
                    position: relative;
                    width: 100.0%;
                    height: 100.0%;
                    left: 0.0%;
                    top: 0.0%;
                }
                .leaflet-container { font-size: 1rem; }
            </style>

            <style>html, body {
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
            }
            </style>

            <style>#map {
                position:absolute;
                top:0;
                bottom:0;
                right:0;
                left:0;
                }
            </style>

            <script>
                L_NO_TOUCH = false;
                L_DISABLE_3D = false;
            </script>

        
<link href="https://fonts.googleapis.com/css2?family=Oswald&display=swap" rel="stylesheet">
</head>
<body>
    
    
            <div class="folium-map" id="map_b33b6e6260203368c111134a9ea78e3e" ></div>
        

<script>
window.addEventListener("DOMContentLoaded", function () {
    // üîç Znajd≈∫ ID mapy wygenerowanej przez Folium
    const mapId = document.querySelector(".folium-map")?.getAttribute("id");
    const map = window[mapId];
    if (!map) return;

    // üì• Wczytaj dane GeoJSON (linie + punkty z atrybutami)
    fetch('expeditions.geojson')
        .then(res => res.json())
        .then(data => {
            const groupLayers = [];  // wszystkie trasy i markery
            const routeLayers = [];  // tylko trasy i ich elementy

            // üîÅ Przejd≈∫ przez wszystkie trasy w pliku
            data.features.forEach(feature => {
                // ‚û§ Obs≈Çugujemy tylko linie (trasy)
                if (feature.geometry.type !== "LineString") return;

                const coords = feature.geometry.coordinates;
                const props = feature.properties;

                // üîß Wydobycie atrybut√≥w
                const trailColor = props.color || '#654321'; // Chocolate
                const trailNr = props.nr || '';
                const trailCounter = props.trail_counter || '';
                const trailName = props.name || '';
                const lat = parseFloat(props.lat);
                const lon = parseFloat(props.lon);

                // ‚ñ∂Ô∏è G≈Ç√≥wna linia trasy
                const line = L.geoJSON(feature, {
                    style: {
                        color: trailColor,
                        weight: 3,
                        opacity: 0.8
                    }
                });

                // üè∑Ô∏è Dymek z nazwƒÖ trasy na hover
                line.bindTooltip(
                    `<div style='font-family: Oswald, sans-serif; font-size: 12px;'>
                        ${trailNr} ${trailName}
                    </div>`, { sticky: true }
                );

                // ‚ú® Efekt pod≈õwietlenia linii
                line.on({
                    mouseover: () => {
                        line.setStyle({ weight: 6, color: '#000000' });
                        line.bringToFront();
                    },
                    mouseout: () => {
                        line.setStyle({ weight: 3, color: trailColor });
                    }
                });

                // üü¢ Marker z numerem
                const iconHtml = `
                <div style="
                    font-size: 10px;
                    font-family: Oswald, sans-serif;
                    color: white;
                    background-color: ${trailColor};
                    border-radius: 50%;
                    border: 1px solid white;
                    width: 24px;
                    height: 24px;
                    display: flex;
                    align-items: center;
                    justify-content: center;">
                    ${trailNr}
                </div>`;

                const marker = L.marker([lat, lon], {
                    icon: L.divIcon({
                        className: '',
                        html: iconHtml,
                        iconSize: [24, 24],
                        iconAnchor: [12, 12]
                    })
                });

                marker.bindTooltip(
                    `<div style='font-family: Oswald, sans-serif; font-size: 12px;'>
                        ${trailNr} ${trailName}
                    </div>`, { sticky: true }
                );

                marker.on('mouseover', function () {
                    line.setStyle({ weight: 6, color: '#000000' });
                    line.bringToFront();
                });
                marker.on('mouseout', function () {
                    line.setStyle({ weight: 3, color: trailColor });
                });

                const popupHtml = `
                <div style="font-family: 'Oswald', sans-serif; font-size: 12px;">
                    <table style="border-collapse: collapse;">
                        <tr><th style="text-align: left;">Trail nr:</th><td>${props.nr || ''}</td></tr>
                        <tr><th style="text-align: left;">Date:</th><td>${props.date || ''}</td></tr>
                        <tr><th style="text-align: left;">Trail name:</th><td>${trailName}</td></tr>
                        <tr><th style="text-align: left;">Mountains:</th><td>${props.mountains || ''}</td></tr>
                        <tr><th style="text-align: left;">Country:</th><td>${props.country || ''}</td></tr>
                        <tr><th style="text-align: left;">Distance:</th><td>${props.distance_km || ''} km</td></tr>
                        <tr><th style="text-align: left;">Up:</th><td>${props.ascent_m || ''} m</td></tr>
                        <tr><th style="text-align: left;">Time:</th><td>${props.duration_h || ''} h</td></tr>
                        <tr><th style="text-align: left;">GOT:</th><td>${props.got || ''}</td></tr>
                        <tr><th style="text-align: left;">Counter:</th><td>${trailCounter}</td></tr>
                        <tr><th style="text-align: left;">Participants:</th><td>${props.participants || ''}</td></tr>
                        <tr><th style="text-align: left;">GPX:</th><td><a href="${props.gpx_url || '#'}" target="_blank">Wikiloc Link</a></td></tr>
                    </table>
                </div>
                `;
                marker.bindPopup(popupHtml);

                // üî¥ K√≥≈Çeczka poczƒÖtkowe i ko≈Ñcowe
                const startCircle = L.circleMarker([coords[0][1], coords[0][0]], {
                    radius: 3,
                    color: trailColor,
                    fillColor: trailColor,
                    fillOpacity: 1
                });

                const endCoords = coords[coords.length - 1];
                const endCircle = L.circleMarker([endCoords[1], endCoords[0]], {
                    radius: 3,
                    color: trailColor,
                    fillColor: trailColor,
                    fillOpacity: 1
                });

                // üß© Grupowanie obiekt√≥w
                const group = L.layerGroup([line, marker, startCircle, endCircle]);
                routeLayers.push(group);
                groupLayers.push(marker); // Tylko marker do za≈Çadowania od razu
            });

            // üåç Dodaj tylko markery na start
            const initialLayer = L.layerGroup(groupLayers);
            initialLayer.addTo(map);

            // üß≠ Przy odpowiednim zoomie za≈Çaduj trasy
            let added = false;
            map.on('zoomend', () => {
                if (map.getZoom() >= 10 && !added) {
                    const lines = L.layerGroup(routeLayers);
                    lines.addTo(map);
                    added = true;
                }
            });
        });
});
</script>

</body>
<script>
    
    
            var map_b33b6e6260203368c111134a9ea78e3e = L.map(
                "map_b33b6e6260203368c111134a9ea78e3e",
                {
                    center: [48.88524522540481, 20.563185152538292],
                    crs: L.CRS.EPSG3857,
                    ...{
  "zoom": 7,
  "zoomControl": true,
  "preferCanvas": false,
}

                }
            );

            

        
    
            var tile_layer_f76b2a245dcbf39fc6d7a264935fc262 = L.tileLayer(
                "https://tile.openstreetmap.org/{z}/{x}/{y}.png",
                {
  "minZoom": 0,
  "maxZoom": 19,
  "maxNativeZoom": 19,
  "noWrap": false,
  "attribution": "\u0026copy; \u003ca href=\"https://www.openstreetmap.org/copyright\"\u003eOpenStreetMap\u003c/a\u003e contributors",
  "subdomains": "abc",
  "detectRetina": false,
  "tms": false,
  "opacity": 1,
}

            );
        
    
            tile_layer_f76b2a245dcbf39fc6d7a264935fc262.addTo(map_b33b6e6260203368c111134a9ea78e3e);
        
    
            var layer_control_07bbbdcd067fc2203c4318423cd74c0f_layers = {
                base_layers : {
                    "openstreetmap" : tile_layer_f76b2a245dcbf39fc6d7a264935fc262,
                },
                overlays :  {
                },
            };
            let layer_control_07bbbdcd067fc2203c4318423cd74c0f = L.control.layers(
                layer_control_07bbbdcd067fc2203c4318423cd74c0f_layers.base_layers,
                layer_control_07bbbdcd067fc2203c4318423cd74c0f_layers.overlays,
                {
  "position": "topright",
  "collapsed": true,
  "autoZIndex": true,
}
            ).addTo(map_b33b6e6260203368c111134a9ea78e3e);

        
</script>
</html>